<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Mini Game Bot</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body { font-family: Arial; background:#0f172a; color:#fff; margin:0; padding:0; }
    .card { background:#111827; margin:12px; padding:16px; border-radius:12px; }
    button { padding:12px; border-radius:10px; border:0; width:100%; font-size:16px; cursor:pointer; }
    .primary { background:#22c55e; color:#000; margin-top:10px; }
    .muted { color:#9ca3af; font-size:13px; }
  </style>
</head>
<body>

<div class="card">
  <h2>ðŸ‘¤ User Dashboard</h2>
  <p id="user"></p>
  <p>ðŸª™ Coins: <b id="coins">0</b></p>
  <p>ðŸ’° Wallet: â‚¹<b id="wallet">0</b></p>
</div>

<div class="card">
  <button class="primary" onclick="startLevel1()"â–¶ï¸ Start Level 1</button>
</div>

<div class="card">
  <button id="watchAdBtn" onclick="watchAd()" disabled>ðŸ“º Watch Ad to Unlock Game</button>
  <p class="muted" id="adInfo">Watch ads to unlock gameplay.</p>
</div>

<div class="card" id="gameCard" style="display:none;">
  <h3>ðŸŽ® Click Game</h3>
  <p>Click the button as fast as you can to earn points!</p>
  <button class="primary" onclick="playGame()">Click Me!</button>
  <p>Score: <b id="score">0</b></p>
</div>

<script>
  const tg = window.Telegram.WebApp;
  tg.ready();

  const user = tg.initDataUnsafe.user;
  document.getElementById("user").innerText =
    `ID: ${user?.id || "-"} | ${user?.first_name || ""}`;

  let coins = 0;
  let wallet = 0;
  let adsWatched = 0;
  let adsRequired = 2; // Admin adjustable later
  let score = 0;
  let levelUnlocked = false;

  function startLevel1(){
    alert(`Level 1 started! You need to watch ${adsRequired} ads to unlock gameplay.`);
    document.getElementById("watchAdBtn").disabled = false;
  }

  function watchAd(){
    adsWatched++;
    coins += 1; // 1 coin per ad
    document.getElementById("coins").innerText = coins;

    if(adsWatched >= adsRequired){
      document.getElementById("watchAdBtn").disabled = true;
      alert("ðŸŽ‰ Level 1 unlocked! Now you can play the game.");
      document.getElementById("adInfo").innerText = "Level 1 unlocked!";
      levelUnlocked = true;
      document.getElementById("gameCard").style.display = "block";
    } else {
      document.getElementById("adInfo").innerText = `Ads watched: ${adsWatched}/${adsRequired}`;
    }
  }

  function playGame(){
    if(!levelUnlocked){
      alert("Please watch required ads to unlock the game!");
      return;
    }
    score++;
    coins += 1; // earn coin per click
    wallet += 1; // add to wallet
    document.getElementById("score").innerText = score;
    document.getElementById("coins").innerText = coins;
    document.getElementById("wallet").innerText = wallet;
  }
</script>

</body>
</html>